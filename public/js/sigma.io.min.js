!function e(t,n,a){function o(r,s){if(!n[r]){if(!t[r]){var d="function"==typeof require&&require;if(!s&&d)return d(r,!0);if(i)return i(r,!0);throw new Error("Cannot find module '"+r+"'")}var c=n[r]={exports:{}};t[r][0].call(c.exports,function(e){var n=t[r][1][e];return o(n?n:e)},c,c.exports,e,t,n,a)}return n[r].exports}for(var i="function"==typeof require&&require,r=0;r<a.length;r++)o(a[r]);return o}({1:[function(e){(function(){"use strict";var t=window,n=t.Sigma={};n.host="http://192.168.0.1",n.port=1337,n.socket=io.connect(n.host),n.clickAndTouchListener=e("./modules/clickAndTouchListener.js"),n.mouseWheelAndTouchMove=e("./modules/mouseWheelAndTouchMove.js"),n.connectOrCreateButton=e("./modules/connectOrCreateButton.js"),n.date=e("./modules/date.js"),n.addContent=e("./modules/addContent.js"),n.updateContent=e("./modules/updateContent.js"),n.deleteContent=e("./modules/deleteContent.js"),n.preventPasting=e("./modules/preventPasting.js"),n.dragAndDrop=e("./modules/dragAndDrop.js"),n.storeImage=e("./modules/storeImage.js"),n.loadResponsiveImages=e("./modules/loadResponsiveImages.js"),n.asyncUserAndHistoryState=e("./modules/asyncUserAndHistoryState.js"),n.makeOwnerArticlesEditable=e("./modules/makeOwnerArticlesEditable.js"),n.observeWidth=e("./modules/observeWidth.js"),n.tools=e("./modules/tools.js"),n.setObservers=e("./modules/setObservers.js"),n.droppedImages=e("./modules/droppedImages.js"),n.simpleCounter=e("./modules/simpleCounter.js"),n.synchronize=e("./modules/synchronize.js"),n.contentEditing=e("./modules/contentEditing.js"),n.getChannelId=e("./modules/getChannelId.js"),n.getMongoId=e("./modules/getMongoId.js"),n.changeId=e("./modules/changeId.js"),n.getTempId=e("./modules/getTempId.js"),n.listen=e("./modules/listen.js"),n.disconnectObservers=e("./modules/disconnectObservers.js"),n.getHistory=e("./modules/getHistory.js"),n.getMoreHistory=e("./modules/getMoreHistory.js"),n.tryLocalStorage=e("./modules/tryLocalStorage.js"),n.heroHeader=e("./modules/heroHeader.js"),n.navigation=e("./modules/navigation.js"),n.animationListener=e("./modules/animationListener.js"),n.signIn=e("./modules/signIn.js"),n.signUp=e("./modules/signUp.js"),n.userIsConnected=e("./modules/userIsConnected.js"),n.resetAndHighlightUserArticles=e("./modules/resetAndHighlightUserArticles.js"),n.manageMessage=e("./modules/manageMessage.js"),n.getSocketMessage=e("./modules/getSocketMessage.js"),n.saveManager=e("./modules/saveManager.js"),n.isOnLine=e("./modules/isOnLine.js"),n.ready=function(){var e=function(){n.observeWidth(),n.getChannelId(),n.getMongoId(),n.getHistory(),n.getMoreHistory.init(),n.tryLocalStorage.init(),n.getSocketMessage(),n.saveManager.init(),n.preventPasting(),n.dragAndDrop()};document.addEventListener("DOMContentLoaded",e,!1)}()}).call(window)},{"./modules/addContent.js":2,"./modules/animationListener.js":3,"./modules/asyncUserAndHistoryState.js":4,"./modules/changeId.js":5,"./modules/clickAndTouchListener.js":6,"./modules/connectOrCreateButton.js":7,"./modules/contentEditing.js":8,"./modules/date.js":9,"./modules/deleteContent.js":10,"./modules/disconnectObservers.js":11,"./modules/dragAndDrop.js":12,"./modules/droppedImages.js":13,"./modules/getChannelId.js":14,"./modules/getHistory.js":15,"./modules/getMongoId.js":16,"./modules/getMoreHistory.js":17,"./modules/getSocketMessage.js":18,"./modules/getTempId.js":19,"./modules/heroHeader.js":20,"./modules/isOnLine.js":21,"./modules/listen.js":22,"./modules/loadResponsiveImages.js":23,"./modules/makeOwnerArticlesEditable.js":24,"./modules/manageMessage.js":25,"./modules/mouseWheelAndTouchMove.js":26,"./modules/navigation.js":27,"./modules/observeWidth.js":28,"./modules/preventPasting.js":29,"./modules/resetAndHighlightUserArticles.js":30,"./modules/saveManager.js":31,"./modules/setObservers.js":32,"./modules/signIn.js":33,"./modules/signUp.js":34,"./modules/simpleCounter.js":35,"./modules/storeImage.js":36,"./modules/synchronize.js":37,"./modules/tools.js":38,"./modules/tryLocalStorage.js":39,"./modules/updateContent.js":40,"./modules/userIsConnected.js":41}],2:[function(e,t){t.exports=function(e,t,n,a,o,i,r){var s=document.querySelector("main"),d=s.querySelector(".row:first-child"),c=s.querySelector(".row:last-child"),u=null!==d?d.children.length:0,m=null!==c?c.children.length:0,l=document.createElement("div"),g=document.createElement("article");if(e=void 0===e?!1:e,t=void 0===t?!1:t,l.setAttribute("class","row"),g.setAttribute("data-structure","article"),g.setAttribute("class","cell"),t){g.dataset.idType="const",g.dataset.mongoId=n,g.innerHTML=t;var h=g.querySelector("time"),p=h.getAttribute("datetime");h.innerHTML=Sigma.date.forHuman(p)}else{var v=document.createElement("h1");v.setAttribute("data-sigma","title"),v.setAttribute("contenteditable",r),v.appendChild(document.createTextNode(a));var S=document.createElement("h2");S.setAttribute("data-owner",i),S.appendChild(document.createTextNode(i));var f=document.createElement("time");f.appendChild(document.createTextNode(Sigma.date.forHuman())),f.setAttribute("datetime",Sigma.date.forDOM());var b=document.createElement("article");b.setAttribute("data-sigma","content"),b.setAttribute("contenteditable",r),b.appendChild(document.createTextNode(o)),g.appendChild(v),g.appendChild(S),g.appendChild(f),g.appendChild(b)}e?0===m||3===m?(s.appendChild(l),l.appendChild(g)):c.appendChild(g):0===u||3===u?(s.insertBefore(l,s.firstChild),l.appendChild(g)):d.insertBefore(g,d.firstChild)}},{}],3:[function(e,t){t.exports=function(e,t,n,a){var o=["animation","webkitAnimation","MSAnimation","oAnimation"],i=function(t){return t+("animation"===t?e?"end":"start":e?"End":"Start")},r=o.map(i),s=function(){var e=this;n(),a&&r.forEach(function(t){e.removeEventListener(t,s,!1)})};r.forEach(function(e){t.addEventListener(e,s,!1)})}},{}],4:[function(e,t){t.exports={modulesLoaded:0,makeLiveForUser:function(){var e=this;if(Sigma.disconnectObservers(),e.channelIsEmpty){var t=document.querySelector('[data-owner="generated by Sigma"]').parentNode;if(null!==t){t.parentNode.removeChild(t);var n="Welcome here "+Sigma.username+" !",a="It seems that you are the very first person on that channel. Try to edit the title and the content of this article!";Sigma.addContent(!1,void 0,n,a,Sigma.username,!0)}}Sigma.makeOwnerArticlesEditable(),Sigma.tools.attach(),Sigma.connectOrCreateButton(!1),Sigma.resetAndHighlightUserArticles(),Sigma.setObservers(),Sigma.manageMessage(!0,"Hi "+Sigma.username+"! Nice to see you there!",!0)},check:function(){++this.modulesLoaded,this.modulesLoaded>=2&&this.makeLiveForUser()}}},{}],5:[function(e,t){t.exports=function(e,t,n){var a='[data-mongo-id="'+e+'"]',o=document.querySelector("[data-app-width]"),i=document.querySelector(a);switch(i.dataset.idType="const",i.dataset.mongoId=t,n){case"article":Sigma.synchronize(i);break;case"image":i.src=Sigma.host+":"+Sigma.port+"/data/"+t+"/"+o.dataset.appWidth}}},{}],6:[function(e,t){t.exports={functions:{},preventClickIfTouch:function(e){"touchstart"===e.type&&e.preventDefault()},add:function(e,t,n,a){var o=this,i=n;a=a||!1,o.functions[t]=function(e){a||o.preventClickIfTouch(e),i(e)},e.addEventListener("click",o.functions[t],!1),e.addEventListener("touchstart",o.functions[t],!1)},remove:function(e,t){var n=this;e.removeEventListener("click",n.functions[t],!1),e.removeEventListener("touchstart",n.functions[t],!1)}}},{}],7:[function(e,t){t.exports=function(e){var t=function(e){var t=document.querySelector("nav"),n=document.createElement("a"),a=document.createElement("span"),o=function(){if("connect"===e)Sigma.signIn.isVisible||(Sigma.signIn.init(),Sigma.signUp.init(),Sigma.navigation.hide());else{var t="An editable title!",n="Here goes the content of your lovely article. You can directly drag & drop images here!";Sigma.disconnectObservers(),Sigma.addContent(!1,!1,void 0,t,n,Sigma.username,!0),Sigma.tools.attach(),Sigma.resetAndHighlightUserArticles(),Sigma.setObservers()}};n.setAttribute("href","#"),n.setAttribute("class",e),t.lastChild.appendChild(n),n.appendChild(a),a.appendChild(document.createTextNode(e)),Sigma.clickAndTouchListener.add(n,"addFormOrCreate",o)},n=function(e){var t="."+e,n=document.querySelector(t);null!==n&&(Sigma.clickAndTouchListener.remove(n,"addFormOrCreate"),n.parentNode.removeChild(n))};e?(void 0===Sigma.connectOrCreateStatus||Sigma.connectOrCreateStatus!==!0)&&(Sigma.connectOrCreateStatus=!0,n("create"),t("connect")):(void 0===Sigma.connectOrCreateStatus||Sigma.connectOrCreateStatus!==!1)&&(Sigma.connectOrCreateStatus=!1,n("connect"),t("create"))}},{}],8:[function(e,t){t.exports={eraseIt:function(){var e=Sigma.contentEditing.target.current,t=e.dataset.mongoId;e.parentNode.removeChild(e),Sigma.socket.emit(Sigma.getChannelId,{action:"delete",mongoId:t})},addTools:function(e){var t=Sigma.contentEditing,n=document.createElement("div"),a=document.createElement("a"),o=document.createElement("a"),i=t.setArticle(e.target);n.setAttribute("class","tools"),a.setAttribute("class","close"),a.setAttribute("href","#"),a.setAttribute("data-tooltip","close"),o.setAttribute("class","erase"),o.setAttribute("href","#"),o.setAttribute("data-tooltip","erase"),i.appendChild(n),n.appendChild(a),n.appendChild(o),Sigma.clickAndTouchListener.add(a,"removeTools",t.removeTools),Sigma.clickAndTouchListener.add(o,"eraseIt",t.eraseIt),t.formerTarget=e.target.parentNode},manageTools:function(e){var t=Sigma.contentEditing,n=document.querySelector(".tools");if(null===n)t.addTools(e);else{var a=t.setArticle(n);t.target.current!==a&&(n.parentNode.removeChild(n),t.addTools(e));var o=document.querySelector(".erase");Sigma.clickAndTouchListener.remove(o,"eraseIt"),Sigma.clickAndTouchListener.add(o,"eraseIt",t.eraseIt)}},removeTools:function(){var e=document.querySelector(".tools");e.parentNode.removeChild(e)},setArticle:function(e){var t;return t="article"!==e.parentNode.dataset.structure?e.parentNode.parentNode:e.parentNode},editMode:function(e){var t=e.target.parentNode;t.classList.toggle("editMode"),"small"===Sigma.deviceWidth&&Sigma.navigation.hide(),Sigma.contentEditing.target.add=t},viewMode:function(e){var t=e.target.parentNode;t.classList.remove("editMode"),"small"===Sigma.deviceWidth&&Sigma.navigation.show(),t.querySelector("time").setAttribute("datetime",Sigma.date.forDOM()),t.querySelector("time").innerText=Sigma.date.forHuman(),Sigma.droppedImages.delete()},status:function(e,t){var n=this;t=void 0===t?!0:t,t?(e.addEventListener("focus",this.editMode,!0),e.addEventListener("blur",this.viewMode,!0),Sigma.clickAndTouchListener.add(e,"manageTools",n.manageTools,!0)):(e.removeEventListener("focus",this.editMode,!0),e.removeEventListener("blur",this.viewMode,!0),Sigma.clickAndTouchListener.remove(e,"manageTools"))},target:{history:[],set add(e){this.history.push(e),this.history.length>2&&this.history.shift()},get add(){},get current(){return this.history[this.history.length-1]},get former(){return 2===this.history.length?this.history[0]:null}}}},{}],9:[function(e,t){t.exports={forDOM:function(){return(new Date).toISOString()},forHuman:function(e){var t=void 0===e?new Date:new Date(e),n=t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"});return n}}},{}],10:[function(e,t){t.exports=function(e){var t='[data-mongo-id="'+e+'"]',n=document.querySelector(t);null!==n&&n.parentNode.removeChild(n)}},{}],11:[function(e,t){t.exports=function(){void 0!==Sigma.observers&&Sigma.observers.forEach(function(e){e.disconnect()});for(var e=document.querySelectorAll("[data-sigma]"),t=0;t<e.length;++t)e[t].removeEventListener("focus",Sigma.contentEditing.editMode,!0),e[t].removeEventListener("blur",Sigma.contentEditing.viewMode,!0)}},{}],12:[function(e,t){t.exports=function(){var e=function(e,t){var n,a=document.createElement("canvas"),o=a.getContext("2d");if(t){var i,r,s,d,c=120,u=document.createElement("canvas"),m=u.getContext("2d");e.width>e.height?(i=(e.width-e.height)/2,r=0,s=e.height,d=s):e.height>e.width?(i=0,r=(e.height-e.width)/2,s=e.width,d=s):(i=r=0,s=d=e.width),a.width=a.height=c,u.width=u.height=c,m.drawImage(e,i,r,s,d,0,0,c,c),o.clearRect(0,0,c,c),o.beginPath(),o.arc(c/2,c/2,c/2-2,0,2*Math.PI,!0),o.fillStyle=o.createPattern(u,"no-repeat"),o.fill();var l=o.createLinearGradient(0,0,0,150);l.addColorStop(0,"rgba(229, 86, 109, .7)"),l.addColorStop(.25,"rgba(225, 98, 158, .7)"),l.addColorStop(.5,"rgba(195, 104, 213, .7)"),l.addColorStop(.75,"rgba(146, 94, 202, .7)"),l.addColorStop(1,"rgba(108, 83, 181, .7)"),o.lineWidth=2,o.strokeStyle=l,o.stroke(),n=a.toDataURL("image/png")}else{var g=600,h=1e3;e.width>h&&(e.height*=h/e.width,e.width=h),e.height>g&&(e.width*=g/e.height,e.height=g),a.width=e.width,a.height=e.height,o.clearRect(0,0,a.width,a.height),o.drawImage(e,0,0,e.width,e.height),n=a.toDataURL("image/jpeg",.7)}return n},t=function(t,n){if(t.type.match(/image.*/)){var a=document.createElement("img"),o=new FileReader;n.target.parentNode.querySelector('[data-sigma="content"]').appendChild(a),o.readAsArrayBuffer(t),o.onload=function(t){window.URL=window.URL||window.webkitURL;var n=new Blob([new Uint8Array(t.target.result)]),o=window.URL.createObjectURL(n),i=new Image;i.src=o,i.onload=function(){var t=Sigma.getTempId(),n=document.querySelector("[data-app-width]").dataset.appWidth,o=e(i,!0),r=e(i,!1);a.dataset.image="dropped",a.dataset.idType="tmp",a.dataset.mongoId=t,a.dataset.imageWidth="small"===n?"small":"large",Sigma.storeImage(t,o,r)}}}},n=function(){var e=event.dataTransfer.getData("text/plain");event.target.textContent+=" "+e};window.addEventListener("dragenter",function(e){e.preventDefault();var t=e.target.hasAttribute("data-sigma")?!0:!1;t&&e.target.focus()},!1),window.addEventListener("dragleave",function(e){e.preventDefault();var t=e.target.hasAttribute("data-sigma")?!0:!1;t&&e.target.blur()},!1),window.addEventListener("dragover",function(e){e.preventDefault()},!1),window.addEventListener("drop",function(e){e.preventDefault();var a=e.dataTransfer.files,o=e.target.hasAttribute("data-sigma")?!0:!1,i=e.target.parentNode.querySelector("[data-owner]").dataset.owner,r=i===Sigma.username;if(o&&r)if(0!==a.length)for(var s=0;s<a.length;++s)t(a[s],e);else n();e.target.focus()},!1)}},{}],13:[function(e,t){t.exports={removedImageIds:[],lookAtMutations:function(e){var t=e.addedNodes,n=e.removedNodes,a=e.type,o=this,i=function(e,t){var n=function(){e?o.removedImageIds.splice(o.removedImageIds.indexOf(t[r].dataset.mongoId),1):o.removedImageIds.push(t[r].dataset.mongoId)},i=function(e){if("#text"!==t[e].nodeName)t[e].hasAttribute("data-image")&&n();else if(t[e].hasChildNodes())for(var a=t[e].querySelectorAll("[data-image]"),o=0;o<a.length;++o)n()};if(t.length>0&&"childList"===a)for(var r=0;r<t.length;++r)i(r)};i(!1,n),i(!0,t)},"delete":function(){this.removedImageIds.length>0&&(Sigma.socket.emit("deleteImage",{ids:this.removedImageIds}),this.updateImageArray())},updateImageArray:function(){var e=this;Sigma.socket.on("updateImageArray",function(t){e.removedImageIds=t.array})}}},{}],14:[function(e,t){t.exports=function(){Sigma.socket.on("id",function(e){Sigma.getChannelId=e.id,Sigma.listen()})}},{}],15:[function(e,t){t.exports=function(){Sigma.socket.on("history",function(e){if(e.empty){var t="Welcome here pioneer!",n="It seems that you are the very first person on that channel. Please sign in or sign up.";Sigma.addContent(!1,void 0,t,n,"generated by Sigma",!1)}else e.documents.forEach(function(e){Sigma.addContent(!1,e.html,e._id)}),Sigma.currentDate=e.documents[0].date;Sigma.asyncUserAndHistoryState.channelIsEmpty=e.empty,Sigma.asyncUserAndHistoryState.check(),Sigma.loadResponsiveImages()})}},{}],16:[function(e,t){t.exports=function(){Sigma.socket.on("mongoId",function(e){Sigma.changeId(e.tempId,e.id,e.type)})}},{}],17:[function(e,t){t.exports={loadMoreButton:function(){var e=this,t=document.querySelector(".channel");Sigma.clickAndTouchListener.add(t,"requestArticles",e.requestArticles)},requestArticles:function(){Sigma.socket.emit("loadMoreHistory",{date:Sigma.currentDate})},init:function(){Sigma.socket.on("moreHistory",function(e){e.empty||(e.documents.forEach(function(e){Sigma.addContent(!0,e.html,e._id)}),Sigma.currentDate=e.documents.reverse()[0].date),Sigma.loadResponsiveImages()}),this.loadMoreButton()}}},{}],18:[function(e,t){t.exports=function(){Sigma.socket.on("socketMessage",function(e){Sigma.manageMessage(!0,e.message,e.type)})}},{}],19:[function(e,t){t.exports=function(){for(var e=window.crypto.getRandomValues(new Uint32Array(8)),t="",n=0;n<e.length;++n)t+=e[n].toString(16),n<e.length-1&&(t+="-");return t}},{}],20:[function(e,t){t.exports={add:function(){if(void 0===this.isVisible||!this.isVisible){var e=document.querySelector("body"),t=document.querySelector("main"),n=document.createElement("header"),a=document.createElement("h1");e.insertBefore(n,t),n.setAttribute("class","hero"),n.appendChild(a),a.appendChild(document.createTextNode("Create and share data in true real-time.")),this.isVisible=!0}},remove:function(){if(void 0===this.isVisible||this.isVisible){var e=document.querySelector("header");e.parentNode.removeChild(e),this.isVisible=!1}}}},{}],21:[function(e,t){t.exports=function(){return"onLine"in navigator?navigator.onLine:void 0}},{}],22:[function(e,t){t.exports=function(){Sigma.socket.on("broadcast",function(e){switch(Sigma.disconnectObservers(),e.action){case"create":Sigma.addContent(e.html,e.id);break;case"update":Sigma.updateContent(e.html,e.id);break;case"delete":Sigma.deleteContent(e.id)}Sigma.setObservers(),Sigma.loadResponsiveImages()})}},{}],23:[function(e,t){t.exports=function(){for(var e=document.querySelector("[data-app-width]"),t=document.querySelectorAll("[data-image]"),n=function(n){t[n].dataset.imageWidth=e.dataset.appWidth;var a=Sigma.host+":"+Sigma.port+"/data/"+t[n].dataset.mongoId+"/"+e.dataset.appWidth;t[n].setAttribute("src",a)},a=0;a<t.length;++a)n(a)}},{}],24:[function(e,t){t.exports=function(){for(var e=document.querySelectorAll("[data-sigma]"),t=function(t){var n=e[t].parentNode.querySelector("[data-owner]").dataset.owner;e[t].contentEditable=n===Sigma.username?"true":"false"},n=0;n<e.length;++n)t(n)}},{}],25:[function(e,t){t.exports=function(e,t,n){var a=document.querySelector("[data-message]"),o=n?"confirmation":"alert",i=function(){a&&a.parentNode.removeChild(a)},r=function(){if(a)a.dataset.message=o,a.innerHTML=t;else{var e=document.createElement("span"),n=function(e){var t=e.target,n=function(){t.parentNode.removeChild(t)};t.classList.add("removeMessage"),Sigma.animationListener(!0,t,n,!0)};e.dataset.message=o,e.innerHTML=t,Sigma.navigation.visibility||e.classList.add("withNoNavigation");var i=document.querySelector("body");i.appendChild(e),Sigma.clickAndTouchListener.add(e,"eraseMessage",n)}};e?r():i()}},{}],26:[function(e,t){t.exports={preventDefault:function(e){e.preventDefault()},disable:function(e){var t=this;e.addEventListener("mousewheel",t.preventDefault,!1),e.addEventListener("touchmove",t.preventDefault,!1)},enable:function(e){var t=this;e.removeEventListener("mousewheel",t.preventDefault,!1),e.removeEventListener("touchmove",t.preventDefault,!1)}}},{}],27:[function(e,t){t.exports={visibility:!0,hide:function(){if(this.visibility){var e=document.querySelector("nav"),t=document.querySelector("[data-message]");e.classList.add("removeNavigation"),this.visibility=!1,t&&t.classList.add("withNoNavigation")}},show:function(){if(!this.visibility){var e=document.querySelector("nav"),t=document.querySelector("[data-message]");e.classList.remove("removeNavigation"),this.visibility=!0,t&&t.classList.remove("withNoNavigation")}}}},{}],28:[function(e,t){t.exports=function(){var e,t=document.querySelector("[data-app-width]"),n=function(n){e[n].dataset.imageWidth=t.dataset.appWidth;var a=Sigma.host+":"+Sigma.port+"/data/"+e[n].dataset.mongoId+"/"+t.dataset.appWidth;e[n].setAttribute("src",a)},a=function(){var a=window.getComputedStyle(t,"::after").getPropertyValue("content"),o=a.replace(/\"/g,"");t.dataset.appWidth=Sigma.deviceWidth=o,e=document.querySelectorAll("[data-image-width]");for(var i=0;i<e.length;++i)n(i)};Sigma.animationListener(!1,t,a,!1)}},{}],29:[function(e,t){t.exports=function(){window.addEventListener("paste",function(e){Sigma.manageMessage(!0,"Pasting is currently not supported due to cross-browser limitations. Use drag and drop instead.",!1),e.preventDefault()},!1)}},{}],30:[function(e,t){t.exports=function(){for(var e='[data-owner="'+Sigma.username+'"]',t=document.querySelectorAll(e),n=document.querySelectorAll(".isYours"),a=function(e){n[e].classList.remove("isYours")},o=function(e){t[e].parentNode.classList.add("isYours")},i=0;i<n.length;++i)a(i);for(var r=0;r<t.length;++r)o(r)}},{}],31:[function(e,t){t.exports={pool:[],init:function(){Sigma.socket.on("saveState",function(e){void 0!==e.tempId?Sigma.saveManager.toggleState(e.tempId,e.state):void 0!==e.id&&Sigma.saveManager.toggleState(e.id,e.state)})},add:function(e,t){var n=this.find(e);null===n?this.pool.push([e,t]):this.pool[n][1]=t},find:function(e){var t=function(e){return e[0]},n=this.pool.map(t).indexOf(e);return-1!==n?n:null},showSaveState:function(){console.log("S A V E D !!!")},toggleId:function(e,t){var n=this.find(e);null!==n&&(this.pool[n][0]=t)},toggleState:function(e,t){var n=this.find(e);null!==n&&(this.pool[n][1]=t,this.showSaveState())}}},{}],32:[function(e,t){t.exports=function(){for(var e=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,t=[],n=document.querySelectorAll("[data-sigma]"),a=function(a){t[a]=new e(function(e){e.forEach(function(e){Sigma.synchronize(),Sigma.droppedImages.lookAtMutations(e)})}),t[a].observe(n[a],{attributes:!0,childList:!0,characterData:!0,attributeOldValue:!0,subtree:!0,characterDataOldValue:!0})},o=0;o<n.length;++o)a(o);Sigma.observers=t}},{}],33:[function(e,t){t.exports={addForm:function(){var e=this,t=document.querySelector("body"),n=document.createElement("aside"),a=document.createElement("form"),o=document.createElement("div"),i=document.createElement("div"),r=document.createElement("label"),s=document.createElement("label"),d=document.createElement("input"),c=document.createElement("input"),u=document.createElement("span"),m=document.createElement("span"),l=document.createElement("button"),g=function(){var a=function(){n.parentNode.removeChild(n)};Sigma.animationListener(!0,n,a,!0),n.classList.add("removeAside"),t.classList.remove("noScroll"),Sigma.navigation.show(),Sigma.mouseWheelAndTouchMove.enable(t),e.isVisible=!1,Sigma.manageMessage(!1)};a.setAttribute("class","signIn"),a.setAttribute("data-validation","Username and password must be 6 characters long with no white space! Password must contain at least 1 digit!"),o.setAttribute("class","usernameUberInput"),i.setAttribute("class","passwordUberInput"),d.setAttribute("class","username"),d.setAttribute("type","text"),d.setAttribute("placeholder","Username"),d.setAttribute("autofocus",""),c.setAttribute("class","password"),c.setAttribute("type","password"),c.setAttribute("placeholder","Password"),u.setAttribute("id","usernameInputState"),m.setAttribute("id","passwordInputState"),l.setAttribute("type","button"),l.setAttribute("class","cancel"),l.appendChild(document.createTextNode("cancel")),t.classList.toggle("noScroll"),t.insertBefore(n,t.firstChild),n.appendChild(a),a.appendChild(o),a.appendChild(i),o.appendChild(r),o.appendChild(d),o.appendChild(u),i.appendChild(s),i.appendChild(c),i.appendChild(m),a.appendChild(l),Sigma.signIn.form=a,Sigma.mouseWheelAndTouchMove.disable(t),Sigma.clickAndTouchListener.add(l,"returnHome",g)},checkForm:function(){var e=(document.querySelector("form"),document.querySelector(".username").value),t=document.querySelector(".password").value,n=document.querySelector("#usernameInputState"),a=document.querySelector("#passwordInputState"),o=new RegExp("^\\S{6,}$"),i=o.test(e),r=new RegExp("^(?=.*\\d)\\S{6,}$"),s=r.test(t),d=i&&s,c="",u=function(e){var t=document.querySelector("button[type=submit]");if(e){if(!t){var n=document.createElement("button");n.setAttribute("type","submit"),n.appendChild(document.createTextNode("sign in | up")),Sigma.signIn.form.appendChild(n)}}else t&&t.parentNode.removeChild(t)};d?(Sigma.signIn.username=e,Sigma.signIn.password=t,n.className=a.className="isOk",Sigma.manageMessage(!1),u(!0)):(i?""!==e&&(n.className="isOk"):""!==e?(c+="Username must be at least 6 characters long!",n.className="isErroneous"):n.className="",s?""!==t&&(a.className="isOk"):""!==t?(""!==c&&(c+=" "),c+="Password must be at least 6 characters long with one digit!",a.className="isErroneous"):a.className="",""!==c?Sigma.manageMessage(!0,c,!1):Sigma.manageMessage(!1),u(!1))},submit:function(e){e.preventDefault(),Sigma.socket.emit("signIn",{username:Sigma.signIn.username,password:Sigma.signIn.password})},init:function(){this.isVisible=!0,this.addForm(),this.form.addEventListener("input",this.checkForm,!1),this.form.addEventListener("submit",this.submit,!1)}}},{}],34:[function(e,t){t.exports={submit:function(e){e.preventDefault(),Sigma.socket.emit("signUp",{username:Sigma.signIn.username,password:Sigma.signIn.password})},init:function(){Sigma.socket.on("signUp",function(e){Sigma.manageMessage(!0,"Unknown username! Want to sign up as "+e.username+"?",!0);var t=document.querySelector("button[type=submit]");t.innerText="sign up",t.classList.add("signUp"),Sigma.signIn.form.removeEventListener("submit",Sigma.signIn.submit,!1),Sigma.signIn.form.addEventListener("submit",Sigma.signUp.submit,!1)})}}},{}],35:[function(e,t){t.exports={i:0,get value(){return++this.i,this.i}}},{}],36:[function(e,t){t.exports=function(e,t,n){Sigma.socket.emit("storeImage",{tempId:e,smallImage:t,largeImage:n})}},{}],37:[function(e,t){t.exports=function(e){var t=void 0===e?document.activeElement.parentNode:e,n="ARTICLE"===t.nodeName,a="article"===t.dataset.structure;if(n&&a){var o,i,r,s,d,c=t.cloneNode(!0),u=document.createDocumentFragment(),m=function(e){d[e].removeAttribute("src"),d[e].removeAttribute("data-image-width")},l=function(e){editableElements[e].contentEditable="false"};u.appendChild(c),r=u.querySelector(".tools"),null!==r&&r.parentNode.removeChild(r),d=u.querySelectorAll("[data-image-width]");for(var g=0;g<d.length;++g)m(g);editableElements=u.querySelectorAll("[data-sigma]");for(var h=0;h<editableElements.length;++h)l(h);s=u.querySelector('[data-structure="article"]').innerHTML,document.hasFocus()&&(t.hasAttribute("data-mongo-id")?"const"===t.dataset.idType&&(o=t.dataset.mongoId,i=t.querySelector("time").getAttribute("datetime"),Sigma.socket.emit(Sigma.getChannelId,{action:"update",mongoId:o,html:s,owner:Sigma.username,date:i})):(t.dataset.idType="tmp",o=Sigma.getTempId(),t.dataset.mongoId=o,i=t.querySelector("time").getAttribute("datetime"),Sigma.socket.emit(Sigma.getChannelId,{action:"create",mongoId:o,html:s,owner:Sigma.username,date:i})),Sigma.saveManager.add(o,!1))}}},{}],38:[function(e,t){t.exports={attach:function(){for(var e=document.querySelectorAll("[data-sigma]"),t=function(t){var n=e[t].parentNode.querySelector("[data-owner]").dataset.owner;Sigma.username===n&&Sigma.contentEditing.status(e[t])},n=0;n<e.length;++n)t(n)},remove:function(){for(var e=document.querySelectorAll("[data-sigma]"),t=0;t<e.length;++t)Sigma.contentEditing.status(e[t],!1)}}},{}],39:[function(e,t){t.exports={changeUserInterfaceToSign:function(){Sigma.resetAndHighlightUserArticles(),Sigma.connectOrCreateButton(!0),Sigma.heroHeader.add(),Sigma.userIsConnected(),Sigma.setObservers()},storageStateHasChanged:function(){Sigma.tryLocalStorage.clearStorage(),Sigma.manageMessage(!0,"Unwanted LocalStorage change occured. LocalStorage has been cleared.",!1),Sigma.tryLocalStorage.changeUserInterfaceToSign()},storageListener:function(e){var t=this;e?window.addEventListener("storage",t.storageStateHasChanged,!1):window.removeEventListener("storage",t.storageStateHasChanged,!1)},clearStorage:function(){var e=this;e.storageListener(!1),localStorage.clear(),e.storageListener(!0),Sigma.username=void 0,Sigma.tools.remove(),Sigma.makeOwnerArticlesEditable()},init:function(){if("localStorage"in window){var e=this,t=void 0===localStorage.sigma?{username:void 0,password:void 0}:JSON.parse(localStorage.sigma);e.storageListener(!0),Sigma.socket.on("localStorageState",function(n){n.secure?(e.storageListener(!1),Sigma.username=t.username,e.storageListener(!0),Sigma.asyncUserAndHistoryState.check()):(e.clearStorage(),Sigma.manageMessage(!0,"Wrong credentials were stored in local browser. Please sign in or sign up!",!1),e.changeUserInterfaceToSign())}),void 0!==t.username&&void 0!==t.password?Sigma.socket.emit("checkLocalStorage",{username:t.username,password:t.password}):(e.clearStorage(),e.changeUserInterfaceToSign())}else Sigma.manageMessage(!0,"LocalStorage is not supported!",!1)}}},{}],40:[function(e,t){t.exports=function(e,t){var n='[data-mongo-id="'+t+'"]',a=document.querySelector(n);null!==a&&(a.innerHTML=e)}},{}],41:[function(e,t){t.exports=function(){Sigma.socket.on("isConnected",function(e){var t=document.querySelector("aside"),n=document.querySelector("body"),a=function(){var e=function(){console.log(t),null!==t&&t.parentNode.removeChild(t)};Sigma.animationListener(!0,t,e,!0),t.classList.add("removeAside"),n.classList.remove("noScroll"),Sigma.navigation.show(),Sigma.mouseWheelAndTouchMove.enable(n),Sigma.signIn.isVisible=!1,Sigma.manageMessage(!1)};a(),Sigma.username=e.username,Sigma.tryLocalStorage.storageListener(!1),localStorage.sigma=JSON.stringify({username:Sigma.username,password:e.password}),Sigma.tryLocalStorage.storageListener(!0),Sigma.asyncUserAndHistoryState.check(),Sigma.heroHeader.remove()})}},{}]},{},[1]);
!function e(t,n,a){function i(s,r){if(!n[s]){if(!t[s]){var d="function"==typeof require&&require;if(!r&&d)return d(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return i(n?n:e)},c,c.exports,e,t,n,a)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<a.length;s++)i(a[s]);return i}({1:[function(e){(function(){"use strict";var t=window,n=t.Sigma={};n.host="http://127.0.0.1",n.port=1337,n.socket=io.connect(n.host),n.clickAndTouchListener=e("./modules/clickAndTouchListener.js"),n.mouseWheelAndTouchMove=e("./modules/mouseWheelAndTouchMove.js"),n.connectOrCreateButton=e("./modules/connectOrCreateButton.js"),n.date=e("./modules/date.js"),n.addContent=e("./modules/addContent.js"),n.updateContent=e("./modules/updateContent.js"),n.deleteContent=e("./modules/deleteContent.js"),n.preventPasting=e("./modules/preventPasting.js"),n.dragAndDrop=e("./modules/dragAndDrop.js"),n.storeImage=e("./modules/storeImage.js"),n.loadResponsiveImages=e("./modules/loadResponsiveImages.js"),n.asyncUserAndHistoryState=e("./modules/asyncUserAndHistoryState.js"),n.makeOwnerArticlesEditable=e("./modules/makeOwnerArticlesEditable.js"),n.observeWidth=e("./modules/observeWidth.js"),n.tools=e("./modules/tools.js"),n.setObservers=e("./modules/setObservers.js"),n.droppedImages=e("./modules/droppedImages.js"),n.simpleCounter=e("./modules/simpleCounter.js"),n.synchronize=e("./modules/synchronize.js"),n.contentEditing=e("./modules/contentEditing.js"),n.getChannelId=e("./modules/getChannelId.js"),n.getMongoId=e("./modules/getMongoId.js"),n.changeId=e("./modules/changeId.js"),n.getTempId=e("./modules/getTempId.js"),n.listen=e("./modules/listen.js"),n.disconnectObservers=e("./modules/disconnectObservers.js"),n.getHistory=e("./modules/getHistory.js"),n.getMoreHistory=e("./modules/getMoreHistory.js"),n.tryLocalStorage=e("./modules/tryLocalStorage.js"),n.heroHeader=e("./modules/heroHeader.js"),n.navigation=e("./modules/navigation.js"),n.animationListener=e("./modules/animationListener.js"),n.signIn=e("./modules/signIn.js"),n.signUp=e("./modules/signUp.js"),n.userIsConnected=e("./modules/userIsConnected.js"),n.resetAndHighlightUserArticles=e("./modules/resetAndHighlightUserArticles.js"),n.manageMessage=e("./modules/manageMessage.js"),n.getSocketMessage=e("./modules/getSocketMessage.js"),n.saveManager=e("./modules/saveManager.js"),n.isOnLine=e("./modules/isOnLine.js"),n.search=e("./modules/search.js"),n.ready=function(){var e=function(){n.observeWidth(),n.getChannelId(),n.getMongoId(),n.getHistory(),n.getMoreHistory.init(),n.tryLocalStorage.init(),n.getSocketMessage(),n.saveManager.init(),n.preventPasting(),n.dragAndDrop(),n.search()};document.addEventListener("DOMContentLoaded",e,!1)}()}).call(window)},{"./modules/addContent.js":2,"./modules/animationListener.js":3,"./modules/asyncUserAndHistoryState.js":4,"./modules/changeId.js":5,"./modules/clickAndTouchListener.js":6,"./modules/connectOrCreateButton.js":7,"./modules/contentEditing.js":8,"./modules/date.js":9,"./modules/deleteContent.js":10,"./modules/disconnectObservers.js":11,"./modules/dragAndDrop.js":12,"./modules/droppedImages.js":13,"./modules/getChannelId.js":14,"./modules/getHistory.js":15,"./modules/getMongoId.js":16,"./modules/getMoreHistory.js":17,"./modules/getSocketMessage.js":18,"./modules/getTempId.js":19,"./modules/heroHeader.js":20,"./modules/isOnLine.js":21,"./modules/listen.js":22,"./modules/loadResponsiveImages.js":23,"./modules/makeOwnerArticlesEditable.js":24,"./modules/manageMessage.js":25,"./modules/mouseWheelAndTouchMove.js":26,"./modules/navigation.js":27,"./modules/observeWidth.js":28,"./modules/preventPasting.js":29,"./modules/resetAndHighlightUserArticles.js":30,"./modules/saveManager.js":31,"./modules/search.js":32,"./modules/setObservers.js":33,"./modules/signIn.js":34,"./modules/signUp.js":35,"./modules/simpleCounter.js":36,"./modules/storeImage.js":37,"./modules/synchronize.js":38,"./modules/tools.js":39,"./modules/tryLocalStorage.js":40,"./modules/updateContent.js":41,"./modules/userIsConnected.js":42}],2:[function(e,t){t.exports=function(e,t,n,a,i,o,s){var r=document.querySelector("main"),d=r.querySelector(".row:first-child"),c=r.querySelector(".row:last-child"),u=null!==d?d.children.length:0,m=null!==c?c.children.length:0,l=document.createElement("div"),g=document.createElement("article");if(e=void 0===e?!1:e,t=void 0===t?!1:t,l.setAttribute("class","row"),g.setAttribute("data-structure","article"),g.setAttribute("class","cell"),t){g.dataset.idType="const",g.dataset.mongoId=n,g.innerHTML=t;var h=g.querySelector("time"),p=h.getAttribute("datetime");h.innerHTML=Sigma.date.forHuman(p)}else{var S=document.createElement("h1");S.setAttribute("data-sigma","title"),S.setAttribute("contenteditable",s),S.appendChild(document.createTextNode(a));var v=document.createElement("h2");v.setAttribute("data-owner",o),v.appendChild(document.createTextNode(o));var f=document.createElement("time");f.appendChild(document.createTextNode(Sigma.date.forHuman())),f.setAttribute("datetime",Sigma.date.forDOM());var b=document.createElement("article");b.setAttribute("data-sigma","content"),b.setAttribute("contenteditable",s),b.appendChild(document.createTextNode(i)),g.appendChild(S),g.appendChild(v),g.appendChild(f),g.appendChild(b)}e?0===m||3===m?(r.appendChild(l),l.appendChild(g)):c.appendChild(g):0===u||3===u?(r.insertBefore(l,r.firstChild),l.appendChild(g)):d.insertBefore(g,d.firstChild)}},{}],3:[function(e,t){t.exports=function(e,t,n,a){var i=["animation","webkitAnimation","MSAnimation","oAnimation"],o=function(t){return t+("animation"===t?e?"end":"start":e?"End":"Start")},s=i.map(o),r=function(){n(),a&&s.forEach(function(e){this.removeEventListener(e,r,!1)}.bind(this))};s.forEach(function(e){t.addEventListener(e,r,!1)})}},{}],4:[function(e,t){t.exports={modulesLoaded:0,makeLiveForUser:function(){if(Sigma.disconnectObservers(),this.channelIsEmpty){var e=document.querySelector('[data-owner="generated by Sigma"]').parentNode;if(null!==e){e.parentNode.removeChild(e);var t="Welcome here "+Sigma.username+" !",n="It seems that you are the very first person on that channel. Try to edit the title and the content of this article!";Sigma.addContent(!1,!1,void 0,t,n,Sigma.username,!0)}}Sigma.makeOwnerArticlesEditable(),Sigma.tools.attach(),Sigma.connectOrCreateButton(!1),Sigma.resetAndHighlightUserArticles(),Sigma.setObservers(),Sigma.manageMessage(!0,"Hi "+Sigma.username+"! Nice to see you there!",!0)},check:function(){++this.modulesLoaded,this.modulesLoaded>=2&&this.makeLiveForUser()}}},{}],5:[function(e,t){t.exports=function(e,t,n){var a='[data-mongo-id="'+e+'"]',i=document.querySelector("[data-app-width]"),o=document.querySelector(a);switch(o.dataset.idType="const",o.dataset.mongoId=t,n){case"article":Sigma.synchronize(o);break;case"image":o.src=Sigma.host+":"+Sigma.port+"/data/"+t+"/"+i.dataset.appWidth}}},{}],6:[function(e,t){t.exports={functions:{},preventClickIfTouch:function(e){"touchstart"===e.type&&e.preventDefault()},add:function(e,t,n,a){var i=n;a=a||!1,this.functions[t]=function(e){a||this.preventClickIfTouch(e),i(e)}.bind(this),e.addEventListener("click",this.functions[t].bind(this),!1),e.addEventListener("touchstart",this.functions[t].bind(this),!1)},remove:function(e,t){e.removeEventListener("click",this.functions[t].bind(this),!1),e.removeEventListener("touchstart",this.functions[t].bind(this),!1)}}},{}],7:[function(e,t){t.exports=function(e){var t=function(e){var t=document.querySelector("nav"),n=document.createElement("a"),a=document.createElement("span"),i=function(){if("connect"===e)Sigma.signIn.isVisible||(Sigma.signIn.init(),Sigma.signUp.init(),Sigma.navigation.hide());else{var t="An editable title!",n="Here goes the content of your lovely article. You can directly drag & drop images here!";Sigma.disconnectObservers(),Sigma.addContent(!1,!1,void 0,t,n,Sigma.username,!0),Sigma.tools.attach(),Sigma.resetAndHighlightUserArticles(),Sigma.setObservers()}};n.setAttribute("class",e),t.lastChild.appendChild(n),n.appendChild(a),a.appendChild(document.createTextNode(e)),Sigma.clickAndTouchListener.add(n,"addFormOrCreate",i)},n=function(e){var t="."+e,n=document.querySelector(t);null!==n&&(Sigma.clickAndTouchListener.remove(n,"addFormOrCreate"),n.parentNode.removeChild(n))};e?(void 0===Sigma.connectOrCreateStatus||Sigma.connectOrCreateStatus!==!0)&&(Sigma.connectOrCreateStatus=!0,n("create"),t("connect")):(void 0===Sigma.connectOrCreateStatus||Sigma.connectOrCreateStatus!==!1)&&(Sigma.connectOrCreateStatus=!1,n("connect"),t("create"))}},{}],8:[function(e,t){t.exports={eraseIt:function(){var e=Sigma.contentEditing.target.current,t=e.dataset.mongoId;e.parentNode.removeChild(e),Sigma.socket.emit(Sigma.getChannelId,{action:"delete",mongoId:t})},addTools:function(e){var t=Sigma.contentEditing,n=document.createElement("div"),a=document.createElement("a"),i=document.createElement("a"),o=t.setArticle(e.target);n.setAttribute("class","tools"),a.setAttribute("class","close"),a.setAttribute("href","#"),a.setAttribute("data-tooltip","close"),i.setAttribute("class","erase"),i.setAttribute("href","#"),i.setAttribute("data-tooltip","erase"),o.appendChild(n),n.appendChild(a),n.appendChild(i),Sigma.clickAndTouchListener.add(a,"removeTools",t.removeTools),Sigma.clickAndTouchListener.add(i,"eraseIt",t.eraseIt),t.formerTarget=e.target.parentNode},manageTools:function(e){var t=Sigma.contentEditing,n=document.querySelector(".tools");if(null===n)t.addTools(e);else{var a=t.setArticle(n);t.target.current!==a&&(n.parentNode.removeChild(n),t.addTools(e));var i=document.querySelector(".erase");Sigma.clickAndTouchListener.remove(i,"eraseIt"),Sigma.clickAndTouchListener.add(i,"eraseIt",t.eraseIt)}},removeTools:function(){var e=document.querySelector(".tools");e.parentNode.removeChild(e)},setArticle:function(e){var t;return t="article"!==e.parentNode.dataset.structure?e.parentNode.parentNode:e.parentNode},editMode:function(e){var t=e.target.parentNode;t.classList.toggle("editMode"),"small"===Sigma.deviceWidth&&Sigma.navigation.hide(),Sigma.contentEditing.target.add=t},viewMode:function(e){var t=e.target.parentNode;t.classList.remove("editMode"),"small"===Sigma.deviceWidth&&Sigma.navigation.show(),t.querySelector("time").setAttribute("datetime",Sigma.date.forDOM()),t.querySelector("time").innerText=Sigma.date.forHuman(),Sigma.droppedImages.delete()},status:function(e,t){t=void 0===t?!0:t,t?(e.addEventListener("focus",this.editMode,!0),e.addEventListener("blur",this.viewMode,!0),Sigma.clickAndTouchListener.add(e,"manageTools",this.manageTools,!0)):(e.removeEventListener("focus",this.editMode,!0),e.removeEventListener("blur",this.viewMode,!0),Sigma.clickAndTouchListener.remove(e,"manageTools"))},target:{history:[],set add(e){this.history.push(e),this.history.length>2&&this.history.shift()},get add(){},get current(){return this.history[this.history.length-1]},get former(){return 2===this.history.length?this.history[0]:null}}}},{}],9:[function(e,t){t.exports={forDOM:function(){return(new Date).toISOString()},forHuman:function(e){var t=void 0===e?new Date:new Date(e),n=t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"});return n}}},{}],10:[function(e,t){t.exports=function(e){var t='[data-mongo-id="'+e+'"]',n=document.querySelector(t);null!==n&&n.parentNode.removeChild(n)}},{}],11:[function(e,t){t.exports=function(){void 0!==Sigma.observers&&Sigma.observers.forEach(function(e){e.disconnect()});for(var e=document.querySelectorAll("[data-sigma]"),t=0;t<e.length;++t)e[t].removeEventListener("focus",Sigma.contentEditing.editMode,!0),e[t].removeEventListener("blur",Sigma.contentEditing.viewMode,!0)}},{}],12:[function(e,t){t.exports=function(){var e=function(e,t){var n,a=document.createElement("canvas"),i=a.getContext("2d");if(t){var o,s,r,d,c=120,u=document.createElement("canvas"),m=u.getContext("2d");e.width>e.height?(o=(e.width-e.height)/2,s=0,r=e.height,d=r):e.height>e.width?(o=0,s=(e.height-e.width)/2,r=e.width,d=r):(o=s=0,r=d=e.width),a.width=a.height=c,u.width=u.height=c,m.drawImage(e,o,s,r,d,0,0,c,c),i.clearRect(0,0,c,c),i.beginPath(),i.arc(c/2,c/2,c/2-2,0,2*Math.PI,!0),i.fillStyle=i.createPattern(u,"no-repeat"),i.fill();var l=i.createLinearGradient(0,0,0,150);l.addColorStop(0,"rgba(229, 86, 109, .7)"),l.addColorStop(.25,"rgba(225, 98, 158, .7)"),l.addColorStop(.5,"rgba(195, 104, 213, .7)"),l.addColorStop(.75,"rgba(146, 94, 202, .7)"),l.addColorStop(1,"rgba(108, 83, 181, .7)"),i.lineWidth=2,i.strokeStyle=l,i.stroke(),n=a.toDataURL("image/png")}else{var g=600,h=1e3;e.width>h&&(e.height*=h/e.width,e.width=h),e.height>g&&(e.width*=g/e.height,e.height=g),a.width=e.width,a.height=e.height,i.clearRect(0,0,a.width,a.height),i.drawImage(e,0,0,e.width,e.height),n=a.toDataURL("image/jpeg",.7)}return n},t=function(t,n){if(t.type.match(/image.*/)){var a=document.createElement("img"),i=new FileReader;n.target.parentNode.querySelector('[data-sigma="content"]').appendChild(a),i.readAsArrayBuffer(t),i.onload=function(t){window.URL=window.URL||window.webkitURL;var n=new Blob([new Uint8Array(t.target.result)]),i=window.URL.createObjectURL(n),o=new Image;o.src=i,o.onload=function(){var t=Sigma.getTempId(),n=document.querySelector("[data-app-width]").dataset.appWidth,i=e(o,!0),s=e(o,!1);a.dataset.image="dropped",a.dataset.idType="tmp",a.dataset.mongoId=t,a.dataset.imageWidth="small"===n?"small":"large",Sigma.storeImage(t,i,s)}}}},n=function(){var e=event.dataTransfer.getData("text/plain");event.target.textContent+=" "+e};window.addEventListener("dragenter",function(e){e.preventDefault();var t=e.target.hasAttribute("data-sigma")?!0:!1;t&&e.target.focus()},!1),window.addEventListener("dragleave",function(e){e.preventDefault();var t=e.target.hasAttribute("data-sigma")?!0:!1;t&&e.target.blur()},!1),window.addEventListener("dragover",function(e){e.preventDefault()},!1),window.addEventListener("drop",function(e){e.preventDefault();var a=e.dataTransfer.files,i=e.target.hasAttribute("data-sigma")?!0:!1,o=e.target.parentNode.querySelector("[data-owner]").dataset.owner,s=o===Sigma.username;if(i&&s)if(0!==a.length)for(var r=0;r<a.length;++r)t(a[r],e);else n();e.target.focus()},!1)}},{}],13:[function(e,t){t.exports={removedImageIds:[],lookAtMutations:function(e){var t=e.addedNodes,n=e.removedNodes,a=e.type,i=function(e,t){var n=function(){e?this.removedImageIds.splice(_this.removedImageIds.indexOf(t[o].dataset.mongoId),1):this.removedImageIds.push(t[o].dataset.mongoId)}.bind(this),i=function(e){if("#text"!==t[e].nodeName)t[e].hasAttribute("data-image")&&n();else if(t[e].hasChildNodes())for(var a=t[e].querySelectorAll("[data-image]"),i=0;i<a.length;++i)n()};if(t.length>0&&"childList"===a)for(var o=0;o<t.length;++o)i(o)}.bind(this);i(!1,n),i(!0,t)},"delete":function(){this.removedImageIds.length>0&&(Sigma.socket.emit("deleteImage",{ids:this.removedImageIds}),this.updateImageArray())},updateImageArray:function(){Sigma.socket.on("updateImageArray",function(e){this.removedImageIds=e.array})}}},{}],14:[function(e,t){t.exports=function(){Sigma.socket.on("id",function(e){Sigma.getChannelId=e.id,Sigma.listen()})}},{}],15:[function(e,t){t.exports=function(){Sigma.socket.on("history",function(e){if(e.empty){var t="Welcome here pioneer!",n="It seems that you are the very first person on that channel. Please sign in or sign up.";Sigma.addContent(!1,!1,void 0,t,n,"generated by Sigma",!1)}else e.documents.forEach(function(e){Sigma.addContent(!1,e.html,e._id)}),Sigma.currentDate=e.documents[0].date;Sigma.asyncUserAndHistoryState.channelIsEmpty=e.empty,Sigma.asyncUserAndHistoryState.check(),Sigma.loadResponsiveImages()})}},{}],16:[function(e,t){t.exports=function(){Sigma.socket.on("mongoId",function(e){Sigma.changeId(e.tempId,e.id,e.type)})}},{}],17:[function(e,t){t.exports={loadMoreButton:function(){button=document.querySelector(".channel"),Sigma.clickAndTouchListener.add(button,"requestArticles",this.requestArticles)},requestArticles:function(){Sigma.socket.emit("loadMoreHistory",{date:Sigma.currentDate})},init:function(){Sigma.socket.on("moreHistory",function(e){e.empty||(e.documents.forEach(function(e){Sigma.addContent(!0,e.html,e._id)}),Sigma.currentDate=e.documents.reverse()[0].date),Sigma.disconnectObservers(),Sigma.loadResponsiveImages(),Sigma.makeOwnerArticlesEditable(),Sigma.tools.attach(),Sigma.resetAndHighlightUserArticles(),Sigma.setObservers()}),this.loadMoreButton()}}},{}],18:[function(e,t){t.exports=function(){Sigma.socket.on("socketMessage",function(e){Sigma.manageMessage(!0,e.message,e.type)})}},{}],19:[function(e,t){t.exports=function(){for(var e=window.crypto.getRandomValues(new Uint32Array(8)),t="",n=0;n<e.length;++n)t+=e[n].toString(16),n<e.length-1&&(t+="-");return t}},{}],20:[function(e,t){t.exports={add:function(){if(void 0===this.isVisible||!this.isVisible){var e=document.querySelector("body"),t=document.querySelector("main"),n=document.createElement("header"),a=document.createElement("div"),i=document.createElement("h1");subtitle=document.createElement("h2"),e.insertBefore(n,t),n.setAttribute("class","hero"),a.setAttribute("class","svg"),n.appendChild(i),n.appendChild(subtitle),n.appendChild(a),i.appendChild(document.createTextNode("Sigma.io")),subtitle.appendChild(document.createTextNode("Create and share data in true real-time.")),this.isVisible=!0}},remove:function(){if(void 0===this.isVisible||this.isVisible){var e=document.querySelector("header");e.parentNode.removeChild(e),this.isVisible=!1}}}},{}],21:[function(e,t){t.exports=function(){return"onLine"in navigator?navigator.onLine:void 0}},{}],22:[function(e,t){t.exports=function(){Sigma.socket.on("broadcast",function(e){switch(Sigma.disconnectObservers(),e.action){case"create":Sigma.addContent(!1,e.html,e.id);break;case"update":Sigma.updateContent(e.html,e.id);break;case"delete":Sigma.deleteContent(e.id)}Sigma.setObservers(),Sigma.loadResponsiveImages()})}},{}],23:[function(e,t){t.exports=function(){for(var e=document.querySelector("[data-app-width]"),t=document.querySelectorAll("[data-image]"),n=function(n){t[n].dataset.imageWidth=e.dataset.appWidth;var a=Sigma.host+":"+Sigma.port+"/data/"+t[n].dataset.mongoId+"/"+e.dataset.appWidth;t[n].setAttribute("src",a)},a=0;a<t.length;++a)n(a)}},{}],24:[function(e,t){t.exports=function(){for(var e=document.querySelectorAll("[data-sigma]"),t=function(t){var n=e[t].parentNode.querySelector("[data-owner]").dataset.owner;e[t].contentEditable=n===Sigma.username?"true":"false"},n=0;n<e.length;++n)t(n)}},{}],25:[function(e,t){t.exports=function(e,t,n){var a=document.querySelector("[data-message]"),i=n?"confirmation":"alert",o=function(){a&&a.parentNode.removeChild(a)},s=function(){if(a)a.dataset.message=i,a.innerHTML=t;else{var e=document.createElement("span"),n=function(e){var t=e.target,n=function(){t.parentNode.removeChild(t)};t.classList.add("removeMessage"),Sigma.animationListener(!0,t,n,!0)};e.dataset.message=i,e.innerHTML=t,Sigma.navigation.visibility||e.classList.add("withNoNavigation");var o=document.querySelector("body");o.appendChild(e),Sigma.clickAndTouchListener.add(e,"eraseMessage",n)}};e?s():o()}},{}],26:[function(e,t){t.exports={preventDefault:function(e){e.preventDefault()},disable:function(e){e.addEventListener("mousewheel",this.preventDefault,!1),e.addEventListener("touchmove",this.preventDefault,!1)},enable:function(e){e.removeEventListener("mousewheel",this.preventDefault,!1),e.removeEventListener("touchmove",this.preventDefault,!1)}}},{}],27:[function(e,t){t.exports={visibility:!0,hide:function(){if(this.visibility){var e=document.querySelector("nav"),t=document.querySelector("[data-message]");e.classList.add("removeNavigation"),this.visibility=!1,t&&t.classList.add("withNoNavigation")}},show:function(){if(!this.visibility){var e=document.querySelector("nav"),t=document.querySelector("[data-message]");e.classList.remove("removeNavigation"),this.visibility=!0,t&&t.classList.remove("withNoNavigation")}}}},{}],28:[function(e,t){t.exports=function(){var e,t=document.querySelector("[data-app-width]"),n=function(n){e[n].dataset.imageWidth=t.dataset.appWidth;var a=Sigma.host+":"+Sigma.port+"/data/"+e[n].dataset.mongoId+"/"+t.dataset.appWidth;e[n].setAttribute("src",a)},a=function(){var a=window.getComputedStyle(t,"::after").getPropertyValue("content"),i=a.replace(/\"/g,"");t.dataset.appWidth=Sigma.deviceWidth=i,e=document.querySelectorAll("[data-image-width]");for(var o=0;o<e.length;++o)n(o)};Sigma.animationListener(!1,t,a,!1)}},{}],29:[function(e,t){t.exports=function(){window.addEventListener("paste",function(e){Sigma.manageMessage(!0,"Pasting is currently not supported due to cross-browser limitations. Use drag and drop instead.",!1),e.preventDefault()},!1)}},{}],30:[function(e,t){t.exports=function(){for(var e='[data-owner="'+Sigma.username+'"]',t=document.querySelectorAll(e),n=document.querySelectorAll(".isYours"),a=function(e){n[e].classList.remove("isYours")},i=function(e){t[e].parentNode.classList.add("isYours")},o=0;o<n.length;++o)a(o);for(var s=0;s<t.length;++s)i(s)}},{}],31:[function(e,t){t.exports={pool:[],init:function(){Sigma.socket.on("saveState",function(e){void 0!==e.tempId?Sigma.saveManager.toggleState(e.tempId,e.state):void 0!==e.id&&Sigma.saveManager.toggleState(e.id,e.state)})},add:function(e,t){var n=this.find(e);null===n?this.pool.push([e,t]):this.pool[n][1]=t},find:function(e){var t=function(e){return e[0]},n=this.pool.map(t).indexOf(e);return-1!==n?n:null},showSaveState:function(){console.log("S A V E D !!!")},toggleId:function(e,t){var n=this.find(e);null!==n&&(this.pool[n][0]=t)},toggleState:function(e,t){var n=this.find(e);null!==n&&(this.pool[n][1]=t,this.showSaveState())}}},{}],32:[function(e,t){t.exports=function(){var e=document.querySelector("#searchButton"),t=new RegExp("^\\w+$"),n=function(){var e=document.querySelector("#searchInput").value;t.test(e)?window.location=Sigma.host+":"+Sigma.port+"/"+e:Sigma.manageMessage(!0,"A channel should not contain white spaces and special characters!",!1)};Sigma.clickAndTouchListener.add(e,"search",n)}},{}],33:[function(e,t){t.exports=function(){for(var e=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,t=[],n=document.querySelectorAll("[data-sigma]"),a=function(a){t[a]=new e(function(e){e.forEach(function(e){Sigma.synchronize(),Sigma.droppedImages.lookAtMutations(e)})}),t[a].observe(n[a],{attributes:!0,childList:!0,characterData:!0,attributeOldValue:!0,subtree:!0,characterDataOldValue:!0})},i=0;i<n.length;++i)a(i);Sigma.observers=t}},{}],34:[function(e,t){t.exports={addForm:function(){var e=this,t=document.querySelector("body"),n=document.createElement("aside"),a=document.createElement("form"),i=document.createElement("div"),o=document.createElement("div"),s=document.createElement("label"),r=document.createElement("label"),d=document.createElement("input"),c=document.createElement("input"),u=document.createElement("span"),m=document.createElement("span"),l=document.createElement("button"),g=function(){var a=function(){n.parentNode.removeChild(n)};Sigma.animationListener(!0,n,a,!0),n.classList.add("removeAside"),t.classList.remove("noScroll"),Sigma.navigation.show(),Sigma.mouseWheelAndTouchMove.enable(t),e.isVisible=!1,Sigma.manageMessage(!1)};a.setAttribute("class","signIn"),a.setAttribute("data-validation","Username and password must be 6 characters long with no white space! Password must contain at least 1 digit!"),i.setAttribute("class","usernameUberInput"),o.setAttribute("class","passwordUberInput"),d.setAttribute("class","username"),d.setAttribute("type","text"),d.setAttribute("placeholder","Username"),d.setAttribute("autofocus",""),c.setAttribute("class","password"),c.setAttribute("type","password"),c.setAttribute("placeholder","Password"),u.setAttribute("id","usernameInputState"),m.setAttribute("id","passwordInputState"),l.setAttribute("type","button"),l.setAttribute("class","cancel"),l.appendChild(document.createTextNode("cancel")),t.classList.toggle("noScroll"),t.insertBefore(n,t.firstChild),n.appendChild(a),a.appendChild(i),a.appendChild(o),i.appendChild(s),i.appendChild(d),i.appendChild(u),o.appendChild(r),o.appendChild(c),o.appendChild(m),a.appendChild(l),Sigma.signIn.form=a,Sigma.mouseWheelAndTouchMove.disable(t),Sigma.clickAndTouchListener.add(l,"returnHome",g)},checkForm:function(){var e=(document.querySelector("form"),document.querySelector(".username").value),t=document.querySelector(".password").value,n=document.querySelector("#usernameInputState"),a=document.querySelector("#passwordInputState"),i=new RegExp("^\\S{6,}$"),o=i.test(e),s=new RegExp("^(?=.*\\d)\\S{6,}$"),r=s.test(t),d=o&&r,c="",u=function(e){var t=document.querySelector("button[type=submit]");if(e){if(!t){var n=document.createElement("button");n.setAttribute("type","submit"),n.appendChild(document.createTextNode("sign in | up")),Sigma.signIn.form.appendChild(n)}}else t&&t.parentNode.removeChild(t)};d?(Sigma.signIn.username=e,Sigma.signIn.password=t,n.className=a.className="isOk",Sigma.manageMessage(!1),u(!0)):(o?""!==e&&(n.className="isOk"):""!==e?(c+="Username must be at least 6 characters long!",n.className="isErroneous"):n.className="",r?""!==t&&(a.className="isOk"):""!==t?(""!==c&&(c+=" "),c+="Password must be at least 6 characters long with one digit!",a.className="isErroneous"):a.className="",""!==c?Sigma.manageMessage(!0,c,!1):Sigma.manageMessage(!1),u(!1))},submit:function(e){e.preventDefault(),Sigma.socket.emit("signIn",{username:Sigma.signIn.username,password:Sigma.signIn.password})},init:function(){this.isVisible=!0,this.addForm(),this.form.addEventListener("input",this.checkForm,!1),this.form.addEventListener("submit",this.submit,!1)}}},{}],35:[function(e,t){t.exports={submit:function(e){e.preventDefault(),Sigma.socket.emit("signUp",{username:Sigma.signIn.username,password:Sigma.signIn.password})},init:function(){Sigma.socket.on("signUp",function(e){Sigma.manageMessage(!0,"Unknown username! Want to sign up as "+e.username+"?",!0);var t=document.querySelector("button[type=submit]");t.innerText="sign up",t.classList.add("signUp"),Sigma.signIn.form.removeEventListener("submit",Sigma.signIn.submit,!1),Sigma.signIn.form.addEventListener("submit",Sigma.signUp.submit,!1)})}}},{}],36:[function(e,t){t.exports={i:0,get value(){return++this.i,this.i}}},{}],37:[function(e,t){t.exports=function(e,t,n){Sigma.socket.emit("storeImage",{tempId:e,smallImage:t,largeImage:n})}},{}],38:[function(e,t){t.exports=function(e){var t=void 0===e?document.activeElement.parentNode:e,n="ARTICLE"===t.nodeName,a="article"===t.dataset.structure;if(n&&a){var i,o,s,r,d,c=t.cloneNode(!0),u=document.createDocumentFragment(),m=function(e){d[e].removeAttribute("src"),d[e].removeAttribute("data-image-width")},l=function(e){editableElements[e].contentEditable="false"};u.appendChild(c),s=u.querySelector(".tools"),null!==s&&s.parentNode.removeChild(s),d=u.querySelectorAll("[data-image-width]");for(var g=0;g<d.length;++g)m(g);editableElements=u.querySelectorAll("[data-sigma]");for(var h=0;h<editableElements.length;++h)l(h);r=u.querySelector('[data-structure="article"]').innerHTML,document.hasFocus()&&(t.hasAttribute("data-mongo-id")?"const"===t.dataset.idType&&(i=t.dataset.mongoId,o=t.querySelector("time").getAttribute("datetime"),Sigma.socket.emit(Sigma.getChannelId,{action:"update",mongoId:i,html:r,owner:Sigma.username,date:o})):(t.dataset.idType="tmp",i=Sigma.getTempId(),t.dataset.mongoId=i,o=t.querySelector("time").getAttribute("datetime"),Sigma.socket.emit(Sigma.getChannelId,{action:"create",mongoId:i,html:r,owner:Sigma.username,date:o})),Sigma.saveManager.add(i,!1))}}},{}],39:[function(e,t){t.exports={attach:function(){for(var e=document.querySelectorAll("[data-sigma]"),t=function(t){var n=e[t].parentNode.querySelector("[data-owner]").dataset.owner;Sigma.username===n&&Sigma.contentEditing.status(e[t])},n=0;n<e.length;++n)t(n)},remove:function(){for(var e=document.querySelectorAll("[data-sigma]"),t=0;t<e.length;++t)Sigma.contentEditing.status(e[t],!1)}}},{}],40:[function(e,t){t.exports={changeUserInterfaceToSign:function(){Sigma.resetAndHighlightUserArticles(),Sigma.connectOrCreateButton(!0),Sigma.heroHeader.add(),Sigma.userIsConnected(),Sigma.setObservers()},storageStateHasChanged:function(){Sigma.tryLocalStorage.clearStorage(),Sigma.manageMessage(!0,"Unwanted LocalStorage change occured. LocalStorage has been cleared.",!1),Sigma.tryLocalStorage.changeUserInterfaceToSign()},storageListener:function(e){e?window.addEventListener("storage",this.storageStateHasChanged.bind(this),!1):window.removeEventListener("storage",this.storageStateHasChanged.bind(this),!1)},clearStorage:function(){this.storageListener(!1),localStorage.clear(),this.storageListener(!0),Sigma.username=void 0,Sigma.tools.remove(),Sigma.makeOwnerArticlesEditable()},init:function(){if("localStorage"in window){var e=void 0===localStorage.sigma?{username:void 0,password:void 0}:JSON.parse(localStorage.sigma);this.storageListener(!0),Sigma.socket.on("localStorageState",function(t){t.secure?(this.storageListener(!1),Sigma.username=e.username,this.storageListener(!0),Sigma.asyncUserAndHistoryState.check()):(this.clearStorage(),Sigma.manageMessage(!0,"Wrong credentials were stored in local browser. Please sign in or sign up!",!1),this.changeUserInterfaceToSign())}.bind(this)),void 0!==e.username&&void 0!==e.password?Sigma.socket.emit("checkLocalStorage",{username:e.username,password:e.password}):(this.clearStorage(),this.changeUserInterfaceToSign())}else Sigma.manageMessage(!0,"LocalStorage is not supported!",!1)}}},{}],41:[function(e,t){t.exports=function(e,t){var n='[data-mongo-id="'+t+'"]',a=document.querySelector(n);null!==a&&(a.innerHTML=e)}},{}],42:[function(e,t){t.exports=function(){Sigma.socket.on("isConnected",function(e){var t=document.querySelector("aside"),n=document.querySelector("body"),a=function(){var e=function(){null!==t&&t.parentNode.removeChild(t)};Sigma.animationListener(!0,t,e,!0),t.classList.add("removeAside"),n.classList.remove("noScroll"),Sigma.navigation.show(),Sigma.mouseWheelAndTouchMove.enable(n),Sigma.signIn.isVisible=!1,Sigma.manageMessage(!1)};a(),Sigma.username=e.username,Sigma.tryLocalStorage.storageListener(!1),localStorage.sigma=JSON.stringify({username:Sigma.username,password:e.password}),Sigma.tryLocalStorage.storageListener(!0),Sigma.asyncUserAndHistoryState.check(),Sigma.heroHeader.remove()})}},{}]},{},[1]);